window.onload = function(){

	function loadScript() {
	  var script = document.createElement("script");
	  script.type = "text/javascript";
	  script.src = "http://map.qq.com/api/js?v=2.exp&callback=loadMap";
	  document.body.appendChild(script);
	}

	loadScript();

	var FIRST_LOAD = true;

	window.loadMap = function(){
		/*var traces = [
			"39.930456 116.387554",
			"39.929008 116.414162",
			"39.909786 116.379314",
			"39.908206 116.416908",
			"39.918306 116.426808",
			"39.928406 116.436708",
			"39.938506 116.446608",
			"39.948606 116.456508",
			"39.958706 116.466408",
			"39.968806 116.476308",
			"39.958806 116.476308",
			"39.948806 116.476308",
			"39.938806 116.476308",
			"39.928806 116.476308",
			"39.918806 116.476308",
			"39.908806 116.476308",
			"39.898806 116.476308",
			"39.888806 116.476308",
			"39.878806 116.476308",
			"39.878806 116.466308",
			"39.878806 116.456308",
			"39.878806 116.446308",
			"39.878806 116.436308",
			"39.878806 116.426308",
			"39.878806 116.416308",
			"39.878806 116.406308",
			"39.878806 116.396308",
			"39.878806 116.386308",
			"39.878806 116.376308",
		];*/
		var traces = [
			"39.7848340462772 116.49633335855309",
			"39.78484591308099 116.49622362403494",
			"39.78480902653404 116.49542386757676",
			"39.784790986982145 116.4952609213357",
			"39.78479936332239 116.49523764548464",
			"39.78480101205389 116.49524762189357",
			"39.78481931696955 116.49526425234285",
			"39.784895981855826 116.49526925566468",
			"39.78489094218224 116.4952908695008",
			"39.78486253982401 116.4953274428005",
			"39.784864095078674 116.4953889622725",
			"39.78487409602762 116.495388964266",
			"39.78487409602762 116.495388964266",
			"39.7848572800239 116.49547043223667",
			"39.784838884640365 116.495503682171",
			"39.784838884640365 116.495503682171",
			"39.784820223893334 116.49568324789705",
			"39.78477980092466 116.49591435236692",
			"39.784761113019165 116.49610888220806",
			"39.7847324844609 116.49627015646666",
			"39.784699015245 116.49634330771757",
			"39.78463393965168 116.49638153638725",
			"39.784603939790955 116.4963798677273",
			"39.78459225391046 116.49638984147825",
			"39.78455556261623 116.49640147292493",
			"39.78454057324143 116.49639481921685",
			"39.78452722053362 116.49640479263556",
			"39.78452887831224 116.49640978100622",
			"39.78452887831224 116.49640978100622",
			"39.78445375650719 116.49647294787414",
			"39.78441203456674 116.49650120511858",
			"39.7843786377089 116.49653445206258",
			"39.7843335127355 116.49660095026995",
			"39.78405108894306 116.4970032625471",
			"39.784066132625 116.49697998802503",
			"39.78409795921456 116.49689353500625",
			"39.783912552189065 116.49710798377579",
			"39.783900896463315 116.49710133073222",
			"39.78387926089107 116.49708303693902",
			"39.78388104538347 116.49701819277267",
			"39.78385299593903 116.4968602325765",
			"39.78379985660014 116.49675048510068",
			"39.783778380949684 116.49664406929654",
			"39.783713561774036 116.49654097021278",
			"39.78363196873504 116.4964960615873",
			"39.7835420838169 116.49642787378832",
			"39.78346553955798 116.49635636328834",
			"39.783403921300966 116.49632642276501",
			"39.7833222196464 116.49634137059988",
			"39.78324216670718 116.49636629484367",
			"39.78317042978712 116.4964011968254",
			"39.78312366205925 116.49645439326486",
			"39.783073551617875 116.49651257707815",
			"39.78306855415617 116.49651091340198",
			"39.78301344926537 116.4965657708596",
			"39.78295335596223 116.49661397660276",
			"39.782893235485155 116.49667714646084",
			"39.78282979945908 116.49673033957782",
			"39.78274804644122 116.49677355296335",
			"39.78270633953505 116.49679349681051",
			"39.782654604492336 116.49682840277923",
			"39.78260273358343 116.49693812932327",
			"39.78259414885427 116.49707613005651",
			"39.78250205062745 116.49730888690594",
			"39.78259025061058 116.49738705044942",
			"39.78260836834072 116.49750676702467",
			"39.7826281408272 116.49763313464999",
			"39.7826829438942 116.49774454513752",
			"39.78272441536093 116.49785429028758",
			"39.782697564957274 116.49795404573862",
			"39.78268076080945 116.49802886299142",
			"39.7826907406516 116.4980405037411",
			"39.78270242053229 116.49803385534904",
			"39.78270242053229 116.49803385534904",
			"39.78270242053229 116.49803385534904",
			"39.78270071747495 116.49805380717021",
			"39.78266562650754 116.49810201789705",
			"39.782605530076246 116.49815188631956",
			"39.78252708039861 116.49821172716406",
			"39.78245864980579 116.49826159392538",
			"39.782383560946 116.49830647131925",
			"39.7822984650616 116.4983546720786",
			"39.78221166006164 116.49842615001795",
			"39.78211982435954 116.4985142537551",
			"39.78203632279214 116.49860235915355",
			"39.781957842842715 116.49867882679249",
			"39.78187435634925 116.49875861879363",
			"39.781809244245096 116.49881679961663",
			"39.78175085986765 116.49884172817966",
			"39.7816707462749 116.49889990601241",
			"39.781577298026704 116.49895808118714",
			"39.78148883213406 116.49902623343539",
			"39.78139033805273 116.49910934780516",
			"39.78128848612186 116.49920576294605",
			"39.78119494717747 116.4993138185043",
			"39.78110305087107 116.49943517583041",
			"39.78103446903461 116.49956817656425",
			"39.78097420623054 116.49970949235652",
			"39.78093226345446 116.49985912520084",
			"39.78089032371366 116.50000709551352",
			"39.780858380878186 116.50016008454062",
			"39.78082643568074 116.50031474006148",
			"39.7807894782393 116.5004760472311",
			"39.78076920099357 116.5006307057474",
			"39.78072893954687 116.50077538213347",
			"39.78068532376558 116.50093169933547",
			"39.78064836052533 116.5010963330763",
			"39.78060973342559 116.50125930345818",
			"39.7805728027588 116.50140564377531",
			"39.78055752906821 116.50155864061554",
			"39.780542249476284 116.50171496361251",
			"39.7805070123146 116.50184633702904",
			"39.78043522029953 116.50191284456227",
			"39.78033016566602 116.50193776945942",
			"39.78021184739906 116.5019227787031",
			"39.780100211236615 116.5018994740457",
			"39.779995254218505 116.50186951852781",
			"39.77989030606717 116.5018345738739",
			"39.7797836881214 116.50180129192671",
			"39.77967707312589 116.50176634692886",
			"39.779567130377686 116.501728075177",
			"39.77944883277331 116.50170144307675",
			"39.779335547479334 116.5016681597824",
			"39.77922392013811 116.50163986594326",
			"39.779117305106155 116.50160492090885",
			"39.77901236872171 116.50156332401797",
			"39.778920787662145 116.50151008844335",
			"39.778862575720744 116.50143856600411",
			"39.77884108725502 116.50133711605574",
			"39.77885627497071 116.50123234728358",
			"39.77888648190418 116.50111760322814",
			"39.77891670953871 116.50099121787544",
			"39.77895194654351 116.50085984439298",
			"39.77899052018036 116.50072680855855",
			"39.77903076956787 116.50058878415145",
			"39.77906770008781 116.50044244389017",
			"39.77911463461254 116.50029444283331",
			"39.77916828689572 116.50011817221366",
			"39.779210274482836 116.4999419159582",
			"39.77925392669833 116.4997690059339",
			"39.779292578403286 116.49959609491282",
			"39.77933457888096 116.49941487115899",
			"39.77939158082445 116.49923365039541",
			"39.779438587810645 116.49904910227943",
			"39.77948891936767 116.49886954286633",
			"39.779540914712705 116.49869164646492",
			"39.77958124222907 116.49851374773772",
			"39.779619893828986 116.49834083671662",
			"39.77965851215087 116.49818621516951",
			"39.77971215006765 116.49802162053588",
			"39.77977911352666 116.49786201659866",
			"39.779842734235714 116.49770740003524",
			"39.77990299405535 116.49756774692241",
			"39.779983243702716 116.49743474851442",
			"39.78006185975802 116.49728346030014",
			"39.7801521405604 116.4971338370911",
			"39.780235763095185 116.49697922451467",
			"39.780322643684656 116.49686617958905",
			"39.78042285887127 116.49675313732139",
			"39.78053642074089 116.49663344699387",
			"39.780649994672984 116.49650710594867",
			"39.780763556487514 116.49638741562117",
			"39.780883773491944 116.49627437734048",
			"39.781003990469216 116.4961613390598",
			"39.7811175431373 116.49604663677063",
			"39.78123440223784 116.49594689926109",
			"39.78134960053202 116.49584383606032",
			"39.781466459585765 116.49574409855072",
			"39.78157494219777 116.49566763689216",
			"39.781673251661886 116.4956859459689",
			"39.781733076136746 116.49578571869691",
			"39.78179785579295 116.4959104326135",
			"39.78186426604648 116.49605509901576",
			"39.781918984373604 116.49621306452785",
			"39.78197542088799 116.49634276482155",
			"39.78203353632408 116.49646581472967",
			"39.78208831208079 116.49659218933222",
			"39.782144793937434 116.49669694943412",
			"39.78220291545456 116.49681667398336",
			"39.78225940639508 116.49691644604695",
			"39.7823243250931 116.49696467670879",
			"39.78238603092345 116.49694639952801",
			"39.78243942073124 116.4969181446094",
			"39.782514464194634 116.49689820740724",
			"39.782596177983436 116.49687660885456",
			"39.782699642036334 116.49681012227603",
			"39.782828141688405 116.49672535120726",
			"39.782934972568896 116.49664057581919",
			"39.78304847979365 116.4965508137218",
			"39.783163653824644 116.49646105195666",
			"39.783277109701736 116.4963995554099",
			"39.78337709514905 116.49641287678055",
			"39.783478644823404 116.49648272958474",
			"39.78355351321338 116.49655922779075",
			"39.78362669064819 116.4966490271001",
			"39.783683202842774 116.49673716040758",
			"39.78375471347501 116.49682695938472",
			"39.78379953376192 116.49692839180199",
			"39.78384767564465 116.49703647560162",
			"39.78388589803128 116.49709966506256",
			"39.78391924966964 116.49709135831029",
			"39.78396765102666 116.49705645167704",
			"39.784016040313 116.4970281957616",
			"39.78405607132507 116.49701323962056",
			"39.78411447363837 116.4969783349808",
			"39.784162899115714 116.49693012691199",
			"39.78420793663676 116.49691184640874",
			"39.784267954487305 116.49690520765192",
			"39.78432465979654 116.49688692947439",
			"39.78434292552266 116.49692517475657",
			"39.7843378013728 116.49699334361733",
			"39.78435107868374 116.49702493718496",
			"39.78443276228197 116.49701996542683",
			"39.78449114950236 116.49699337418436",
			"39.78454454226918 116.4969634565862",
			"39.78461794600902 116.49692855493674",
			"39.78469470450824 116.49688201519555",
			"39.78470973309503 116.49686705407073",
			"39.78470973309503 116.49686705407073",
			"39.78470973309503 116.49686705407073",
			"39.78470973309503 116.49686705407073",
			"39.78470973309503 116.49686705407073",
			"39.78470973309503 116.49686705407073",
			"39.78470973309503 116.49686705407073",
			"39.78470973309503 116.49686705407073",
			"39.78470973309503 116.49686705407073",
			"39.78470973309503 116.49686705407073",
			"39.78470973309503 116.49686705407073",
			"39.78470973309503 116.49686705407073",
			"39.78470973309503 116.49686705407073",
			"39.78470973309503 116.49686705407073",
			"39.784769868546704 116.4967955708153",
			"39.78478155443017 116.49678559706433",
			"39.78478487300676 116.49679391112608",
			"39.78478487300676 116.49679391112608",
			"39.78478299509139 116.4969102983555",
			"39.78485789979811 116.4969668444081",
			"39.78497628072986 116.49694691584445",
			"39.78502296998845 116.49693694907072",
			"39.78503131015572 116.49693362537307",
			"39.785039650322936 116.49693030167543",
			"39.78504799953543 116.49692198993938",
			"39.78504799953543 116.49692198993938",
			"39.78504799953543 116.49692198993938",
			"39.78504799953543 116.49692198993938",
			"39.78504799953543 116.49692198993938",
			"39.78504799953543 116.49692198993938",
			"39.78504799953543 116.49692198993938",
			"39.78504799953543 116.49692198993938",
			"39.78504799953543 116.49692198993938",
			"39.78504799953543 116.49692198993938",
			"39.78504799953543 116.49692198993938",
			"39.78504799953543 116.49692198993938",
			"39.78504799953543 116.49692198993938",
			"39.78504799953543 116.49692198993938",
			"39.78504799953543 116.49692198993938",
			"39.78504799953543 116.49692198993938",
			"39.78504799953543 116.49692198993938",
			"39.78504799953543 116.49692198993938",
			"39.78504799953543 116.49692198993938",
			"39.78504799953543 116.49692198993938",
			"39.78504799953543 116.49692198993938",
			"39.78504799953543 116.49692198993938",
			"39.78504799953543 116.49692198993938",
			"39.78504799953543 116.49692198993938",
			"39.78504799953543 116.49692198993938",
			"39.78504799953543 116.49692198993938",
			"39.78504799953543 116.49692198993938"
		];

		var len=traces.length-1;
		var center = new qq.maps.LatLng((parseFloat(traces[0].split(" ")[0])+parseFloat(traces[len].split(" ")[0]))/2,
			(parseFloat(traces[0].split(" ")[1])+parseFloat(traces[len].split(" ")[1]))/2);
		//var center = new qq.maps.LatLng(39.916527,116.397128);
		
		var map = new qq.maps.Map(document.getElementById('container'),
		{
		    center:center,
		    zoom: 16,
		});

		qq.maps.event.addListener(map, 'tilesloaded', function(){
			
			if(FIRST_LOAD){
				var path = [];

				//#7877f6
				var polylineColor = new qq.maps.Color(120,119,246,0.6);
				//#1d1fed
				var circleColor = new qq.maps.Color(29,31,237,0.6);

				//var circleFillColor = new qq.maps.Color("#0f0");

				var circleStrokeColor = new qq.maps.Color(0,0,0,1);



				var polyline = new qq.maps.Polyline({
				    strokeColor: polylineColor,
				    strokeWeight: 11,
				    editable:false,
				    map: map
				});

				path = traces.map(function(val, idx){
				    var lat = parseFloat(val.split(' ')[0]);
				    var lng = parseFloat(val.split(' ')[1]);
				    return new qq.maps.LatLng(lat, lng);
				});

				var idx = 0;
				var pathTemp = [];

				polyline.setPath(path);
				var circle=new qq.maps.Circle({
					       	map:map,
					       	center: path[0],
					       	radius: 3,
					       	fillColor: "#0f0",
					       	strokeColor: circleStrokeColor,
					       	strokeWeight:1
					   	});

				/*var pathInterval = setInterval(function(){
					var point = path[idx++];
					var circle=new qq.maps.Circle({
					       	map:map,
					       	center: point,
					       	radius: 4,
					       	fillColor: circleColor,
					       	strokeColor: strokeColor,
					       	strokeWeight:6
					   	});

					pathTemp.push(point);
					polyline.setPath(pathTemp);

					if(idx == len + 1){
						clearInterval(pathInterval);
					}
				}, 200);*/
			}

			FIRST_LOAD = false;
		});		
	};
}